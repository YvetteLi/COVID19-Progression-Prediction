plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(lm(y~poly_x)), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
Title.Graph = "Weighted Least Squares weight scheme 1"
y = dataq2$Sales
x = dataq2$Year
poly_x = poly(dataq2$Year, 3)
#fit.wls1 = lm(y~poly_x, weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(lm(y~poly_x, weights=(a0_hat + a1_hat*x) )), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
Title.Graph = "Weighted Least Squares weight scheme 1"
fit.wls1 = lm(y~poly_x, weights=(a0_hat + a1_hat*x))
fit.wls1$coefficients
fit.wls2 = lm(y~poly_x, weights=1/(a0_hat + a1_hat*x))
fit.wls2$coefficients
y = dataq2$Sales
x = dataq2$Year
poly_x = poly(dataq2$Year, 3)
#fit.wls1 = lm(y~poly_x, weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(lm(y~poly_x, weights=(a0_hat + a1_hat*x))), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
Title.Graph = "Weighted Least Squares weight scheme 1"
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(lm(y~poly_x, weights=1/(a0_hat+a1_hat*x) )), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
Title.Graph = "Weighted Least Squares weight scheme 1"
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(lm(y~poly_x, weights=1/(a0_hat+a1_hat*x) )), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
Title.Graph = "Weighted Least Squares weight scheme 1"
y = dataq2$Sales
x = dataq2$Year
poly_x = poly(dataq2$Year, 3)
#fit.wls1 = lm(y~poly_x, weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
Title.Graph = "Weighted Least Squares weight scheme 1"
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls2), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
Title.Graph = "Weighted Least Squares weight scheme 1"
y = dataq2$Sales
x = dataq2$Year
poly_x = poly(dataq2$Year, 3)
#fit.wls1 = lm(y~poly_x, weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares (a0_hat + a1_hat*x) ")
y = dataq2$Sales
x = dataq2$Year
poly_x = poly(dataq2$Year, 3)
#fit.wls1 = lm(y~poly_x, weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight (a0_hat + a1_hat*x) ")
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls2), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight 1/(a0_hat + a1_hat*x) ")
?predict
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls2, interval="confidence"), type="l", col="blue", lwd=2)
fit.wls1 = lm(y~poly_x, weights=(a0_hat + a1_hat*x))
fit.wls1$coefficients
fit.wls2 = lm(y~poly_x, weights=1/(a0_hat + a1_hat*x))
fit.wls2$coefficients
y = dataq2$Sales
x = dataq2$Year
poly_x = poly(dataq2$Year, 3)
#fit.wls1 = lm(y~poly_x, weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1, interval="confidence"), type="l", col="blue", lwd=2)
y = dataq2$Sales
x = dataq2$Year
poly_x = poly(dataq2$Year, 3)
#fit.wls1 = lm(y~poly_x, weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight (a0_hat + a1_hat*x) ")
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1, interval="confidence"), type="l", col="blue", lwd=2)
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight (a0_hat + a1_hat*x) ")
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1, interval="confidence"), type="l", col="blue", lwd=2)
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval="confidence"), type="l", col="blue", lwd=2)
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1, weihgts = a0_hat + a1_hat*x), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight (a0_hat + a1_hat*x) ")
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1, data.frame(x=x), weihgts = a0_hat + a1_hat*x), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight (a0_hat + a1_hat*x) ")
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1, data.frame(x=x), weihgts = a0_hat + a1_hat*x, interval = "confidence"), type="l", col="blue", lwd=2)
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1, data.frame(x=poly(x,3)), weihgts = a0_hat + a1_hat*x, interval = "confidence"), type="l", col="blue", lwd=2)
length(y)
length(x)
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1, data.frame(x=x), weihgts = a0_hat + a1_hat*x, interval = "confidence"), type="l", col="blue", lwd=2)
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval = "confidence"), type="l", col="blue", lwd=2)
predict(fit.wls1, weihgts = a0_hat + a1_hat*x)
predict(fit.wls2, interval="confidence")
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls1, weihgts = a0_hat + a1_hat*x), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight (a0_hat + a1_hat*x) ")
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
lines(x, predict(fit.wls2, weights=1/(a0_hat + a1_hat*x) ), type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight 1/(a0_hat + a1_hat*x) ")
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x)
upper = pred$upr
pred = predict(fit.wls2, interval="confidence")
pred[1]
pred[:, 1]
pred[, 1]
pred[, "fit"]
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x)
upper = pred[,"upr"]
pred[, "fit"]
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
lines(x, fitted, type="l", col="blue", lwd=2)
polygon(x=x, y=c(pred$upper, pred$lower))
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
lines(x, fitted, type="l", col="blue", lwd=2)
polygon(x=x, y=c(lower,upper))
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
lines(x, fitted, type="l", col="blue", lwd=2)
polygon(x=x, y=c(lower,rev(upper)))
?polygon
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
lines(x, fitted, type="l", col="blue", lwd=2)
polygon(x=x, y=list("lower"=lower, "upper"=upper)
text(8,7,"Black: True")
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
lines(x, fitted, type="l", col="blue", lwd=2)
polygon(x=x, y=list("lower"=lower, "upper"=upper))
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
lines(x, fitted, type="l", col="blue", lwd=2)
polygon(x=x, y=list("lower"=lower))
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
lines(x, fitted, type="l", col="blue", lwd=2)
lines(x, upper, type="l", col="red", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight (a0_hat + a1_hat*x) ")
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
lines(x, fitted, type="l", col="blue", lwd=2)
lines(x, upper, type="l", col="red", lwd=2)
lines(x, lowerr, type="l", col="green", lwd=2)
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
lines(x, fitted, type="l", col="blue", lwd=2)
lines(x, upper, type="l", col="red", lwd=2)
lines(x, lower, type="l", col="green", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight (a0_hat + a1_hat*x) ")
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
lines(x, fitted, type="l", col="blue", lwd=2)
polygon(c(x, rev(x)), c(lower, rev(upper)), col="thistle", border=NA)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight (a0_hat + a1_hat*x) ")
y = dataq2$Sales
x = dataq2$Year
# poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
polygon(c(x, rev(x)), c(lower, rev(upper)), col="thistle", border=NA)
lines(x, fitted, type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight (a0_hat + a1_hat*x) ")
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls2, weights=1/(a0_hat + a1_hat*x), interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
polygon(c(x, rev(x)), c(lower, rev(upper)), col="thistle", border=NA)
lines(x, fitted, type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight 1/(a0_hat + a1_hat*x) ")
fit.wls3 = lm(y~poly(x, 3), weights=1/var_table$sigma2.y)
var_table$sigma2.y)
var_table$sigma2.y
var_table
sigma2(xi) = c()
sigma2(x) = c()
sigma2xi = c()
helper_func <- function(df){}
dataq2
var_table
var_table %>% select(where(var_table$Year == 1999))
var_table %>% select(var_table$Year == 1999)
var_table %>% select(Year == 1999)
var_table %>% select(Year)
var_table["Year", var_table[Year = 1999]]
var_table["Year", var_table[Year == 1999]]
var_table["Year", var_table["Year" == 1999]]
var_table[, "Year" == 1999]
var_table[, "Year" == 2000]
var_table
var_table %>% filter(Year == 1999)
filter(var_table, Year == 1999)
filter(var_table, Year == 1999)$sigma2.y
for (row in 1:nrow(dataq2)){
yr = dataq2[[row, "Year"]]
dataq2[[row, "sigma2xi"]] = filter(var_table, Year == year)$sigma2.y
}
for (row in 1:nrow(dataq2)){
yr = dataq2[[row, "Year"]]
dataq2[[row, "sigma2xi"]] = filter(var_table, Year == yr)$sigma2.y
}
dataq2$sigma2xi = 0
for (row in 1:nrow(dataq2)){
yr = dataq2[[row, "Year"]]
dataq2[[row, "sigma2xi"]] = filter(var_table, Year == yr)$sigma2.y
}
dataq2
dataq2$sigma2xi = 0
for (row in 1:nrow(dataq2)){
yr = dataq2[[row, "Year"]]
dataq2[[row, "sigma2xi"]] = filter(var_table, Year == yr)$sigma2.y
}
fit.wls3 = lm(y~poly(x, 3), weights=1/sigma2xi)
dataq2$sigma2xi = 0
for (row in 1:nrow(dataq2)){
yr = dataq2[[row, "Year"]]
dataq2[[row, "sigma2xi"]] = filter(var_table, Year == yr)$sigma2.y
}
fit.wls3 = lm(y~poly(x, 3), weights=1/dataq2$sigma2xi)
pred = predict(fit.wls3, weights=1/var_table$sigma2.y, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
polygon(c(x, rev(x)), c(lower, rev(upper)), col="thistle", border=NA)
dataq2$sigma2xi = 0
for (row in 1:nrow(dataq2)){
yr = dataq2[[row, "Year"]]
dataq2[[row, "sigma2xi"]] = filter(var_table, Year == yr)$sigma2.y
}
fit.wls3 = lm(y~poly(x, 3), weights=1/dataq2$sigma2xi)
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls3, weights=1/var_table$sigma2.y, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
polygon(c(x, rev(x)), c(lower, rev(upper)), col="thistle", border=NA)
lines(x, fitted, type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight 1/sigma^2(xi) ")
# Model in Q2
lm(y~poly(x,3))
# Model in Q2
summary(lm(y~poly(x,3)))
# Model in Q2
q2model = lm(y~poly(x,3)))
# Model in Q2
q2model = lm(y~poly(x,3))
# Model in Q2
q2model = lm(y~poly(x,3))
summary(q2model)
summary(q2model)
# Model in Q2
q2model = lm(y~poly(x,3))
summary(q2model)$Coefficients
# Model in Q2
q2model = lm(y~poly(x,3))
summary(q2model)$
# Model in Q2
q2model = lm(y~poly(x,3))
summary(q2model)
# Model in Q2
q2model = lm(y~poly(x,3))
summary(q2model)$coefficients[ , 2]
# Model in Q3c)
summary(fit.wls1)
summary(fit.wls2)
# Model in Q3c)
summary(fit.wls1)$coefficients[ , 2]
summary(fit.wls2)$coefficients[ , 2]
# Mddel in Q4a)
summary(fit.wls3)$coefficients[ , 2]
fit.wls3
summary(fit.wls3)$coefficients
summary(fit.wls3)$coefficients[,2 ]
# Mddel in Q4a)
summary(fit.wls3)$coefficients[ , 2]
summary(fit.wls3)
summary(fit.wls2)
summary(fit.wls1)
summary(q2model)
y = dataq2$Sales
x = dataq2$Year
poly_x = poly(dataq2$Year, 3)
fit.wls1 = lm(y~poly_x, weights=(a0_hat + a1_hat*x))
fit.wls1$coefficients
fit.wls2 = lm(y~poly_x, weights=1/(a0_hat + a1_hat*x))
fit.wls2$coefficients
fit.wls1 = lm(y~poly(x, 3), weights=(a0_hat + a1_hat*x))
# fit.wls1$coefficients
plot(y~x,pch=19 , col=adjustcolor("brown",0.7) , cex.axis=1.5 , cex.lab=1.5)
pred = predict(fit.wls1, weihgts = a0_hat + a1_hat*x, interval="confidence")
upper = pred[,"upr"]
lower = pred[, "lwr"]
fitted = pred[, "fit"]
polygon(c(x, rev(x)), c(lower, rev(upper)), col="thistle", border=NA)
lines(x, fitted, type="l", col="blue", lwd=2)
text(8,7,"Black: True")
text(8,6.5,"Blue: Fitted" , col="blue")
title(main="Weighted Least Squares with Weight (a0_hat + a1_hat*x) ")
getwd()
